<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BabavÃ¡rÃ³ buli â€“ Tippeld meg a baba nemÃ©t</title>
<link rel="icon" href="data:image/svg+xml,
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
  <text y='.9em' font-size='90'>ğŸ‘¶</text>
</svg>">
<style>
/* =========================
   GLOBÃLIS SKÃLA â€“ MOBILRA
========================= */
:root {
  --scale: clamp(0.82, 100vw / 420, 1);
}

/* =========================
   RESET + BODY
========================= */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: "Segoe UI", sans-serif;
  background: linear-gradient(135deg, #ffd6e8, #d6e8ff);
  min-height: 100dvh;
  overflow-y: auto;
  overscroll-behavior-y: auto;
  font-size: calc(16px * var(--scale));
}

/* =========================
   WRAPPER
========================= */
.wrapper {
  display: grid;
  grid-template-columns: 1fr 1.3fr 1fr;
  gap: calc(30px * var(--scale));
  width: 100vw;
  min-height: 100dvh;
  padding: calc(30px * var(--scale));
}

/* =========================
   BOXOK
========================= */
.box {
  background: white;
  border-radius: calc(30px * var(--scale));
  padding: calc(30px * var(--scale));
  box-shadow: 0 15px 40px rgba(0,0,0,0.15);
  overflow: hidden;
}

/* =========================
   CENTER
========================= */
.center {
  text-align: center;
  box-shadow: 0 20px 50px rgba(0,0,0,0.2);
}

/* =========================
   INPUT
========================= */
input {
  padding: calc(14px * var(--scale));
  width: 80%;
  border-radius: calc(12px * var(--scale));
  border: 1px solid #ccc;
  font-size: calc(15px * var(--scale));
  margin: calc(16px * var(--scale)) 0;
}

/* =========================
   BALLOONS
========================= */
.balloons {
  display: flex;
  justify-content: space-around;
  margin-top: calc(24px * var(--scale));
}

.balloon {
  width: calc(100px * var(--scale));
  height: calc(130px * var(--scale));
  border-radius: 50% 50% 45% 45%;
  cursor: pointer;
  position: relative;
  transition: transform 0.2s;
}

.balloon:hover {
  transform: scale(1.05);
}

.balloon::after {
  content: "";
  position: absolute;
  bottom: calc(-28px * var(--scale));
  left: 50%;
  width: 2px;
  height: calc(28px * var(--scale));
  background: #999;
}

.pink {
  background: radial-gradient(circle at 30% 30%, #fff, #ff69b4);
}

.blue {
  background: radial-gradient(circle at 30% 30%, #fff, #5dade2);
}

/* =========================
   POP ANIMATION
========================= */
.pop {
  animation: pop 0.4s forwards;
}

@keyframes pop {
  to {
    transform: scale(2);
    opacity: 0;
  }
}

/* =========================
   LISTÃK
========================= */
ul {
  list-style: none;
  padding: 0;
  margin-top: calc(12px * var(--scale));
}

li {
  padding: calc(8px * var(--scale)) 0;
  border-bottom: 1px solid #eee;
}

/* =========================
   COUNTS
========================= */
.counts {
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
  align-items: center;
  margin: calc(8px * var(--scale)) 0;
}

.count {
  font-size: calc(24px * var(--scale));
  font-weight: 700;
}

.pink-text { color: #ff69b4; }
.blue-text { color: #5dade2; }

/* =========================
   CANVAS
========================= */
canvas {
  position: fixed;
  top: 0;
  left: 0;
  pointer-events: none;
}

/* =========================
   LOADING
========================= */
.loading,
.mobile-loading {
  text-align: center;
  font-style: italic;
  color: #888;
  font-size: calc(13px * var(--scale));
}

.mobile-loading {
  display: none;
  min-height: calc(32px * var(--scale));
}

/* =========================
   MOBILE BUTTONS
========================= */
.mobile-buttons {
  display: none;
}

.mobile-buttons button {
  flex: 1;
  padding: calc(12px * var(--scale));
  border-radius: calc(14px * var(--scale));
  border: none;
  font-size: calc(14px * var(--scale));
  font-weight: 600;
  color: white;
  cursor: pointer;
}

.mobile-buttons button:first-child {
  background: #ff69b4;
}

.mobile-buttons button:last-child {
  background: #5dade2;
}

/* =========================
   POPUP
========================= */
.popup {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: calc(32px * var(--scale));
  border-radius: calc(25px * var(--scale));
  text-align: center;
  width: 90%;
  max-width: 380px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.3);
}

.popup-content h2 {
  margin-top: 0;
  font-size: calc(22px * var(--scale));
}

.popup-content button {
  margin-top: calc(20px * var(--scale));
  padding: calc(14px * var(--scale)) calc(28px * var(--scale));
  font-size: calc(15px * var(--scale));
  border: none;
  border-radius: calc(12px * var(--scale));
  cursor: pointer;
  background: linear-gradient(135deg, #ff69b4, #5dade2);
  color: white;
}

/* =========================
   MOBIL SPECIÃLIS
========================= */
@media (max-width: 900px) {

  .wrapper {
    display: block;
    padding: calc(16px * var(--scale));
  }

  .box.center {
    min-height: 100dvh;
    max-height: 100dvh;
    padding: calc(20px * var(--scale));
    display: flex;
    flex-direction: column;
    gap: calc(10px * var(--scale));
    overflow: hidden;
  }

  .wrapper > .box:not(.center) {
    display: none !important;
  }

  .mobile-buttons {
    display: flex;
    gap: calc(12px * var(--scale));
  }

  .mobile-loading {
    display: block;
  }
}

/* =========================
   EXTRA RÃ–VID KIJELZÅ
========================= */
@media (max-width: 900px) and (max-height: 700px) {

  .balloons {
    margin-top: calc(12px * var(--scale));
    margin-bottom: calc(12px * var(--scale));
  }

  li {
    padding: calc(6px * var(--scale)) 0;
  }
}

</style>

<script src="./config.js"></script>
</head>

<body>

<canvas id="confetti"></canvas>

<div class="wrapper">

    <!-- LÃNY -->
    <div class="box">
        <h2 style="color:#ff69b4">ğŸ’— LÃ¡ny tippek</h2>
        <ul id="girlList"></ul>
    </div>
    

    <!-- KÃ–ZÃ‰P -->
   <div class="box center">
  <h1>ğŸ‰ BabavÃ¡rÃ³ buli ğŸ‰</h1>
  <p>Tippeld meg a baba nemÃ©t!</p>

  <input type="text" id="name" placeholder="Add meg a neved">

  <div class="balloons">
    <div class="balloon pink" onclick="vote('kislÃ¡ny', this)"></div>
    <div class="balloon blue" onclick="vote('kisfiÃº', this)"></div>
  </div>

  <!-- âœ… MOBIL GOMBOK -->
 

  <!-- âœ… SZÃMLÃLÃ“K -->
<div class="counts">
  <div class="count pink-text">
    ğŸ’— <span id="girlCount">0</span>
  </div>
  <div class="count blue-text">
    ğŸ’™ <span id="boyCount">0</span>
  </div>

  <p id="mobileLoading" class="mobile-loading">
    â³ Pillanatâ€¦ betÃ¶ltÅ‘dnek a tippjeitek!
  </p>
</div>

<div class="mobile-buttons">
  <button onclick="openTips('girl')">ğŸ’— LÃ¡ny tippek</button>
  <button onclick="openTips('boy')">ğŸ’™ FiÃº tippek</button>
</div>
       <p id="message"></p>

  </div>
        <!-- FIÃš -->
    <div class="box">
        <h2 style="color:#5dade2">ğŸ’™ FiÃº tippek</h2>
        <ul id="boyList"></ul>
    </div>

  
</div>
    
  <!-- POPUP -->
<div id="popup" class="popup">
  <div class="popup-content">
    <h2 id="popupTitle"></h2>
    <p id="popupText"></p>
    <button onclick="closePopup()">TovÃ¡bb</button>
  </div>
</div>
    <div id="tipsPopup" class="popup">
  <div class="popup-content">
    <h2 id="tipsTitle"></h2>
    <ul id="tipsContent"></ul>
    <button onclick="closeTips()">BezÃ¡rÃ¡s</button>
  </div>
</div>



<script>
const API_URL = window.APP_CONFIG.API_URL;


/* ===== KONFETTI ===== */
let canvas, ctx;

document.addEventListener("DOMContentLoaded", () => {
  canvas = document.getElementById("confetti");
  ctx = canvas.getContext("2d");
  resizeCanvas();
  renderLists();
});

let confetti = [];

function createConfetti(color) {
    for (let i = 0; i < 120; i++) {
        confetti.push({
            x: Math.random() * canvas.width,
            y: -10,
            size: Math.random() * 6 + 4,
            speed: Math.random() * 4 + 2,
            color
        });
    }
    animateConfetti();
}

function animateConfetti() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    confetti.forEach((p, i) => {
        ctx.fillStyle = p.color;
        ctx.fillRect(p.x, p.y, p.size, p.size);
        p.y += p.speed;
        if (p.y > canvas.height) confetti.splice(i, 1);
    });
    if (confetti.length > 0) requestAnimationFrame(animateConfetti);
}

/* ===== LISTÃK BETÃ–LTÃ‰SE SHEETS-BÅL ===== */
function renderLists() {
    const girl = document.getElementById("girlList");
    const boy = document.getElementById("boyList");
    const mobileLoading = document.getElementById("mobileLoading");
if (mobileLoading) mobileLoading.style.display = "block";


    // â³ BETÃ–LTÃ‰S JELZÃ‰S
    girl.innerHTML = `<li class="loading">â³ Pillanatâ€¦<br>betÃ¶ltÅ‘dnek a tippjeitek!</li>`;
    boy.innerHTML = `<li class="loading">â³ Pillanatâ€¦<br>betÃ¶ltÅ‘dnek a tippjeitek!</li>`;

    fetch(API_URL)
        .then(r => r.json())
        .then(tips => {
            girl.innerHTML = "";
            boy.innerHTML = "";

            let girlCounter = 0;
            let boyCounter = 0;

            tips
              .filter(t => t.name && t.choice)
              .forEach(t => {
                const li = document.createElement("li");
                li.textContent = t.name;

                if (t.choice === "kislÃ¡ny") {
                    girl.appendChild(li);
                    girlCounter++;
                } else if (t.choice === "kisfiÃº") {
                    boy.appendChild(li);
                    boyCounter++;
                }
              });

            document.getElementById("girlCount").innerText = girlCounter;
            document.getElementById("boyCount").innerText = boyCounter;

            if (mobileLoading) {
  mobileLoading.innerText =
    "ğŸ‘€ Ha kÃ­vÃ¡ncsi vagy, kattints a gombokra ğŸ‘‡";
}

        })
        .catch(() => {
            girl.innerHTML = `<li class="loading">ğŸ˜• Nem sikerÃ¼lt betÃ¶lteni</li>`;
            boy.innerHTML = `<li class="loading">ğŸ˜• Nem sikerÃ¼lt betÃ¶lteni</li>`;
            mobileLoading.innerText = "ğŸ˜• Nem sikerÃ¼lt betÃ¶lteni a tippeket";

        });
}


/* ===== SZAVAZÃS ===== */
function vote(choice, balloon) {
  const nameInput = document.getElementById("name");
  const name = nameInput.value.trim();
  if (!name) return alert("Add meg a neved!");

  // ğŸ‰ 1. AZONNALI UI VISSZAJELZÃ‰S
  const color = choice === "kislÃ¡ny" ? "#ff69b4" : "#5dade2";

  balloon.classList.add("pop");
  createConfetti(color);

  document.getElementById("popupTitle").innerText =
    choice === "kislÃ¡ny" ? "ğŸ’— KislÃ¡nyra szavaztÃ¡l!" : "ğŸ’™ KisfiÃºra szavaztÃ¡l!";
  document.getElementById("popupText").innerText = `KÃ¶szÃ¶njÃ¼k, ${name}!`;


  setTimeout(() => {
    document.querySelectorAll(".balloon").forEach(b => b.classList.remove("pop"));
  }, 400);

  // ğŸ“¡ 2. ADATKÃœLDÃ‰S HÃTTÃ‰RBEN
fetch(API_URL, {
  method: "POST",
  body: new URLSearchParams({
    name: name,
    choice: choice
  })
})

.then(async r => {
  const text = await r.text();
  try {
    return JSON.parse(text);
  } catch {
    throw new Error("Nem JSON vÃ¡lasz: " + text);
  }
})
.then(res => {
  if (res.id) {
    sessionStorage.setItem("voteId", res.id);
    renderLists();
    document.getElementById("popup").style.display = "flex";
  } else {
    alert(res.message || "MentÃ©si hiba");
  }
})
.catch(err => {
  console.error(err);
  alert("API hiba ğŸ˜•");
});

}

/* INIT */

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}

// csak valÃ³di orientÃ¡ciÃ³vÃ¡ltÃ¡skor
window.addEventListener("orientationchange", () => {
    setTimeout(resizeCanvas, 300);
});


function closePopup() {
  const id = sessionStorage.getItem("voteId");
  if (!id) {
    alert("HiÃ¡nyzÃ³ azonosÃ­tÃ³. Szavazz Ãºjra kÃ©rlek!");
    return;
  }
  window.location.href =
    "https://attilabekecs.github.io/genderrevealparty/mikorszuletikababa.html?id=" + encodeURIComponent(id);
}

function openTips(type) {
    const title = document.getElementById("tipsTitle");
    const content = document.getElementById("tipsContent");

    title.innerText = type === "girl" ? "ğŸ’— LÃ¡ny tippek" : "ğŸ’™ FiÃº tippek";

    const sourceList = type === "girl"
        ? document.getElementById("girlList")
        : document.getElementById("boyList");

    content.innerHTML = sourceList.innerHTML || "<li>MÃ©g nincs tipp</li>";

    document.getElementById("tipsPopup").style.display = "flex";
}

function closeTips() {
    document.getElementById("tipsPopup").style.display = "none";
}


</script>

</body>
</html>
