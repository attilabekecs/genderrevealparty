<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>Mire nem lesz idej√ºk a sz√ºl≈ëknek?</title>
<link rel="icon" href="data:image/svg+xml,
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
  <text y='.9em' font-size='90'>üë∂</text>
</svg>">


<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: "Segoe UI", sans-serif;
    background: linear-gradient(135deg, #ffe4ef, #e4f0ff);
    min-height: 100vh;

    display: flex;
    justify-content: center; /* v√≠zszint */
    align-items: center;     /* f√ºgg≈ëleges */
    padding: 30px;
}


.container {
    width: 100%;
    max-width: 900px;
    min-height: 75vh;
    gap: 10px;

    background: white;
    border-radius: 32px;
    padding: 50px 40px;

    box-shadow: 0 25px 60px rgba(0,0,0,0.18);

    display: flex;
    flex-direction: column;
    justify-content: center;
}


h1, p {
    text-align: center;
    margin-top: 0;
}

/* K√ÅRTY√ÅK */
.cards {
    margin-top: 50px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 24px;
}

.card {
    background: linear-gradient(135deg, #ffd6e8, #d6e8ff);
    border-radius: 28px;
    padding: 26px 20px;
    text-align: center;
    cursor: pointer;
    box-shadow: 0 8px 22px rgba(0,0,0,0.18);
    transition: transform 0.2s, box-shadow 0.2s;
}

.card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 28px rgba(0,0,0,0.22);
}

.emoji {
    font-size: 34px;
    margin-bottom: 10px;
}

.label {
    font-weight: 600;
    margin-bottom: 8px;
}

.result {
    font-size: 14px;
    color: #444;
}

@media (max-width: 600px) {

  .container {
    padding: 30px 20px;
    border-radius: 24px;
  }

  h1 {
    font-size: 22px;
  }

  p {
    font-size: 15px;
  }

  /* üîë 2 csempe egym√°s mellett */
  .cards {
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
    margin-top: 30px;
  }

  .card {
    padding: 20px 14px;
    border-radius: 22px;
  }

  .emoji {
    font-size: 28px;
  }

  .label {
    font-size: 14px;
  }

  .result {
    font-size: 13px;
  }
  .card:active {
    transform: scale(0.97);
  }
}

</style>
</head>

<body>

<div class="container">
    <h1>üòÇ Mire nem lesz idej√ºk a sz√ºl≈ëknek?</h1>
    <p>Kattints arra, ami szerinted biztosan h√°tt√©rbe szorul!</p>
<div id="loading" style="
  text-align:center;
  font-size:16px;
  color:#777;
  margin-top:30px;
">
  ‚è≥ Szavazatok bet√∂lt√©se‚Ä¶
</div>

    <div class="cards" id="cards"></div>
</div>

<script>
const API_URL =
"https://script.google.com/macros/s/AKfycbzGeN4_fKs7H9nwXjxPIFCoTExj1Y9VTKbSBtYldXK1OykD-iq0HCO6pzARAVpyOEVk/exec";

const urlParams = new URLSearchParams(window.location.search);
const userId = urlParams.get("id");

if (!userId) {
  alert("Hi√°nyz√≥ azonos√≠t√≥!");
}

/* ===== ADATOK ===== */
const cardsData = [
  { id: "alvas", label: "Alv√°s", emoji: "üò¥" },
  { id: "kave", label: "Nyugodt k√°v√©", emoji: "‚òï" },
  { id: "zuhany", label: "Hossz√∫ zuhany", emoji: "üöø" },
  { id: "sorozat", label: "Sorozatn√©z√©s", emoji: "üì∫" },
  { id: "randi", label: "Randiz√°s", emoji: "üíë" },
  { id: "csend", label: "Csend", emoji: "ü§´" },
  { id: "rend", label: "Rend √©s tisztas√°g", emoji: "üßº" },
  { id: "enido", label: "√ânid≈ë", emoji: "üéÆ" },
  { id: "telefon", label: "Telefon nyugodtan", emoji: "üì±" },
  { id: "melegkaja", label: "Meleg √©tel", emoji: "üçΩÔ∏è" },
  { id: "ataludt", label: "√Åtaludt √©jszaka", emoji: "üõå" },
  { id: "zene", label: "Zenehallgat√°s", emoji: "üéµ" },
  { id: "mosas", label: "Mos√°s utol√©r√©se", emoji: "üß∫" },
  { id: "gondolat", label: "Egybef√ºgg≈ë gondolat", emoji: "üß†" },
  { id: "nyugodteste", label: "Nyugodt este", emoji: "üïØÔ∏è" },
  { id: "sport", label: "Sportol√°s", emoji: "üèÉ‚Äç‚ôÇÔ∏è" }
];

/* ===== √ÅLLAPOT ===== */
let voteCounts = {};
let voting = false;
const cardMap = {};

const loadingEl = document.getElementById("loading");

function showLoading(text = "‚è≥ Szavazatok bet√∂lt√©se‚Ä¶") {
  loadingEl.innerText = text;
  loadingEl.style.display = "block";
}

function hideLoading() {
  loadingEl.style.display = "none";
}

/* ===== CSEMP√âK L√âTREHOZ√ÅSA (EGYSZER) ===== */
function buildCards() {
  const container = document.getElementById("cards");

  cardsData.forEach(c => {
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <div class="emoji">${c.emoji}</div>
      <div class="label">${c.label}</div>
      <div class="result">Szavazat: 0 db</div>
    `;

    card.onclick = () => vote(c.id);

    container.appendChild(card);
    cardMap[c.id] = card;
  });
}

/* ===== UI FRISS√çT√âS ===== */
function updateUI() {
  cardsData.forEach(c => {
    const card = cardMap[c.id];
    if (!card) return;

    const count = voteCounts[c.id] || 0;

    card.style.opacity = "1";

    card.querySelector(".result").innerText =
      `Szavazat: ${count} db`;
  });
}



/* ===== SZAVAZ√ÅS ===== */
async function vote(optionId) {
  if (voting) return;
  voting = true;

  voteCounts[optionId] = (voteCounts[optionId] || 0) + 1;
  updateUI();

  try {
    await fetch(API_URL, {
      method: "POST",
      body: new URLSearchParams({
        id: userId,
        vote: optionId
      })
    });

    setTimeout(async () => {
  showLoading("üîÑ Friss√≠t√©s‚Ä¶");
  await loadCounts();
  updateUI();
  hideLoading();
}, 1000);


  } finally {
    voting = false;
  }
}

/* ===== ADAT BET√ñLT√âS ===== */
async function loadCounts() {
  try {
    const res = await fetch(API_URL + "?mode=counts");
    const data = await res.json();
    if (data && !data.error) {
      voteCounts = data;
    }
  } catch (err) {
    console.error("Counts load error:", err);
  }
}


/* ===== IND√çT√ÅS ===== */
async function loadAll() {
  showLoading();
  await loadCounts();
  updateUI();
  hideLoading();
}

buildCards();
loadAll();


</script>

</body>
</html>
